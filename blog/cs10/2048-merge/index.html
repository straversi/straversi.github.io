<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>2048 Merge</title>
  <meta name="description" content="">


  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700,600' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="/blog/css/main.css">
  <link rel="canonical" href="http://steven.codes/blog/cs10/2048-merge/">
  <link rel="alternate" type="application/rss+xml" title="steven.codes" href="http://steven.codes/blog/feed.xml">

  <script src="/blog/javascript/headroom.min.js"></script>

  
    
      <link rel="stylesheet" href="/blog/assets/posts/cs10/2048-merge/2048_board.css " media="screen" type="text/css">
    
  

  
    
      <script src='/blog/assets/posts/cs10/2048-merge/2048_board_merge.js ' type="text/javascript"></script>
    
  
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/blog/">steven.codes</a>
    <a class="site-title-mobile" href="/blog/">steven<br>.codes</a>
    <!-- <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
        
          
        
          
        
          
            
              <a class="page-link" href="/blog/resume/">Résumé</a>
            
          
        
          
            
              <a class="page-link" href="/blog/social/">Social</a>
            
          
        
      </div>
    </nav> -->
    <div class="new-nav">
      <div class="nav-box">
        <!-- Index is posts -->
        
          <a href="/blog/">posts</a>
        
      </div>
      
        
      
        
      
        
      
        
          <div class="nav-box">
            
              <a href="/blog/resume/">résumé</a>
            
          </div>
        
      
        
          <div class="nav-box">
            
              <a href="/blog/social/">social</a>
            
          </div>
        
      
    </div>

  </div>

</header>
<!-- Spacer -->
<div class="wrapper"></div>

<!-- Uncomment to activate Headroom.js -->
<!-- <script>
  var headerElement = document.querySelector("header");
  Headroom.options.offset = headerElement.offsetHeight;
  Headroom.options.tolerance.down = 7;
  var headroom = new Headroom(headerElement);
  headroom.init();
</script> -->


    <div class="page-content">
      <div class="wrapper">

        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">2048 Merge</h1>
    <p class="post-meta">
      <time datetime="2015-11-12T03:47:36-08:00" itemprop="datePublished">Nov 12, 2015</time>
      
      <!-- <br>Read in about 5  minutes -->
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <!-- JavaScript and CSS loaded in _includes/head.html.
     Check front matter. -->

<p>In the fad game 2048, you press arrow keys to move tiles across a board in
one of four possible directions. Let’s explore an intuitive algorithm for
accomplishing this.</p>

<hr />

<h2 id="basic-slide">Basic Slide</h2>

<p>Let’s start with the case of a single tile.</p>

<p><span class="important">Note:</span> Throughout this exploration, we will
only ever be considering a single column. This is because in a true 2048
board with 4 columns, each column is independent from the rest when it
comes to merging tiles upward.</p>

<p>What happens when we press the UP arrow? The tile should move up until it
hits an edge.</p>

<div class="board-wrapper">
<div class="board-2048" style="width:62.5px;height:250px;">
  <img class="tile" data-val="2" data-endval="2" data-begin="3" data-end="0" />
</div>
<label onclick="mergeBoard(this)"><input type="checkbox" /><span>merge up</span></label>
</div>

<p>Let’s start a list of rules that we have to keep in mind. We’ll keep adding
to it as we go.</p>

<p>Rules</p>

<blockquote>
  <ol>
    <li>Move up until:
      <ul>
        <li>There is an edge</li>
      </ul>
    </li>
  </ol>
</blockquote>

<h2 id="another-tile">Another Tile</h2>

<p>Now we’ll progress our algorithm by looking at a more complex board. It will
have two tiles of different values.</p>

<p>What happens when we press the UP arrow? The top tile, following our rules
list, will move up until there is an edge. Then it’s the bottom tile’s turn.
It starts to move up… and then encounters a new situation. Instead of
hitting an edge, it hits another tile. What should happen?</p>

<div class="board-wrapper">
<div class="board-2048" style="width:62.5px;height:250px;">
  <img class="tile" data-val="2" data-endval="2" data-begin="1" data-end="0" />
  <img class="tile" data-val="4" data-endval="4" data-begin="3" data-end="1" />
</div>
<label onclick="mergeBoard(this)"><input type="checkbox" /><span>merge up</span></label>
</div>

<p>The tile should stop as if it has hit an edge. It now occupies the spot
directly under the tile above it. Let’s update our rules to reflect
this:</p>

<blockquote>
  <ol>
    <li>Move up until:
      <ul>
        <li>There is an edge</li>
        <li>There is another tile</li>
      </ul>
    </li>
  </ol>
</blockquote>

<p><span class="important">Notice:</span> This brings up a question. Which tile should we move up first? If we move the bottom tile up first, it would stop when it got to the
tile above it. Then we’d move the tile above it, and it’d stop at the edge.
What’s left is a gap between the two tiles! This is not what we want.
Therefore, we’ll make an observation that we should move the tiles up in
order from top to bottom.</p>

<h2 id="merging-tiles">Merging Tiles</h2>

<p>If you missed the notice right before this section definitely read it.</p>

<p>Let’s make things more complex again. In our newest board, there are two
tiles of the same value.</p>

<p>What happens when we press the UP arrow? Now things are getting interesting.
The top tile, following our rules list, will move up until there is an edge.
Then it’s the bottom tile’s turn. It starts to move up… and then
encounters a new situation. It hits another tile with the same value. What
should happen?</p>

<div class="board-wrapper">
<div class="board-2048" style="width:62.5px;height:250px;">
  <img class="tile" data-val="2" data-endval="4" data-begin="1" data-end="0" />
  <img class="tile" data-val="2" data-endval="0" data-begin="3" data-end="0" />
</div>
<label onclick="mergeBoard(this)"><input type="checkbox" /><span>merge up</span></label>
</div>

<p>The tiles should merge into a new tile of twice their values. Let’s add a
rule:</p>

<blockquote>
  <ol>
    <li>Move up until:
      <ul>
        <li>There is an edge</li>
        <li>There is another tile…
          <ul>
            <li>Different value? Do nothing.</li>
            <li>Same value? Merge with it.</li>
          </ul>
        </li>
      </ul>
    </li>
  </ol>
</blockquote>

<h2 id="merge-mishaps">Merge Mishaps</h2>

<p>Let’s add one more twist of complexity. Our next board will have three tiles
on it: Two of the same value and one of twice their value.</p>

<p>What happens when we press the UP arrow? The top tile, following our rules
list, will move up until there is an edge. Then it’s the next tile’s turn.
It moves up and encounters a tile. Does it have the same value? Yes it does,
so it will merge into it to make a new tile of twice its value. Then it’s
the bottom tile’s turn. It moves up, and encounters the freshly merged tile
above it… What should happen?</p>

<div class="board-wrapper">
<div class="board-2048" style="width:62.5px;height:250px;">
  <img class="tile" data-val="4" data-endval="8" data-begin="1" data-end="0" />
  <img class="tile" data-val="4" data-endval="0" data-begin="2" data-end="0" />
  <img class="tile" data-val="8" data-endval="8" data-begin="3" data-end="1" />
</div>
<label onclick="mergeBoard(this)"><input type="checkbox" /><span>merge up</span></label>
</div>

<p>The third tile should stop! One of the rules of 2048 is that a tile cannot
be merged more than once per key press. Let’s add a rule to take care of
this:</p>

<blockquote>
  <ol>
    <li>Move up until:
      <ul>
        <li>There is an edge</li>
        <li>There is another tile…
          <ul>
            <li>Different value? Do nothing.</li>
            <li>Same value?
              <ul>
                <li>Already merged that tile? Do nothing.</li>
                <li>Haven’t merged that tile yet? Merge with it.</li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>We have all of the parts of a perfectly fine 2048 Merging algorithm. These
simple rules are all it takes to power an addicting and popular game. There
are more things we could do: perhaps you may find it useful to keep track of
whether or not a tile has been moved as a result of attempting a merge (this
could be useful when deciding whether to add a new tile when implementing
a full 2048 game).</p>

<p><br /></p>

<p>You can write this algorithm iteratively or recursively. Explore, and
write your own improved version now that you understand the basics.
There are many other ways to achieve the merge effect, and some solutions
can get very clever and efficient. <span>&amp;#9632</span></p>

<h1 id="testing">TESTING</h1>

<p><img src="/blog/assets/posts/cs10/2048-merge/test.png" alt="Image of Yaktocat" /></p>

<script>
  // Run setup method. Find in 2048_board_merge.js from YAML front matter.
  tileSetup("/blog/assets/posts/cs10/2048-merge/2048_tiles/");
</script>


  </div>

</article>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">steven.codes</h3>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Steven Traversi</li>
          <li><a href="mailto:straversi@berkeley.edu">straversi@berkeley.edu</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/straversi"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">straversi</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/StevenTraversi"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">StevenTraversi</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
